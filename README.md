# 电机效率统一分析系统

## 系统概述

本系统是一个基于双电机配置的电磁感应效率测量与分析平台，集成了双机标定法和因素探究两大功能模块。系统既能精确测量单个电机的效率，又能系统研究各种物理因素对效率的影响规律。采用高频数据采集、实时计算和可视化分析技术，为电机效率优化提供全面的实验平台。

## 核心特点

### 双机标定实验
- **创新测量方法**：通过两台相同电机交替作为驱动和发电机，精确计算单机效率
- **双重验证机制**：提供验证实验（平均功率法）和理论实验（实时功率法）两种分析方法
- **正反向测试**：自动计算正向、反向和综合效率，全面评估电机性能

### 因素探究实验
- **多因素研究**：支持磁场强度、温度、转速、负载电阻等因素的影响分析
- **趋势可视化**：自动生成效率随因素变化的趋势图和拟合曲线
- **优化建议**：自动识别最优工作点，提供系统优化方案

### 技术特性
- **高频数据采集**：支持87.5kHz采样率，确保数据精度
- **多通道同步测量**：8通道同时采集，避免分时测量误差
- **实时可视化**：即时显示电流、功率和效率曲线
- **智能数据处理**：自动计算统计值，支持数据截取和异常值处理

## 系统架构

### 硬件配置
- 两台相同型号的微型直流永磁电机（30W/12V）
- 多功能数据采集器（DAQ331M）
- 电流采样模块（基于霍尔效应）
- 可调直流电源（30V/5A）
- 滑动变阻器作为负载

### 软件组成
- **unified_calculator.py**：核心计算引擎，实现效率计算算法
- **unified_app.py**：PyQt6图形界面，提供用户交互和数据可视化

## 实验原理

### 双机标定法
系统采用两台相同电机（效率设为η）进行组合测试：
1. 测试1：电机A驱动，电机B发电，测得系统效率η1 = η²
2. 测试2：电机B驱动，电机A发电，测得系统效率η2 = η²
3. 单机效率计算：η = ⁴√(η1 × η2)

### 效率计算方法

#### 验证实验（使用通道AIN1-2）
- 基于平均功率法
- 假设输入功率恒定
- 效率 = ∫(I²R)dt / (P_avg × t)

#### 理论实验（使用通道AIN5-7）
- 基于实时功率测量
- 实时采集输入输出功率
- 效率 = ∫P_out dt / ∫P_in dt

## 使用指南

### 环境要求
```bash
Python >= 3.10
pandas >= 1.5.0
numpy >= 1.20.0
PyQt6 >= 6.4.0
matplotlib >= 3.5.0
```

### 安装步骤
```bash
# 克隆项目
git clone [项目地址]

# 安装依赖
pip install -r requirements.txt
```

### 运行系统
```bash
python unified_app.py
```

### 操作流程
1. **数据准备**：确保CSV数据文件格式正确（第一行为时间戳，后续为各通道数据）
2. **文件导入**：分别导入正接和反接实验数据文件
3. **参数设置**：
   - 电流比例值（A/V）：电流传感器灵敏度，默认0.185
   - 基准电压（V）：零电流偏置，默认2.52
   - 负载电阻（Ω）：发电机负载值
   - 驱动电压（V）：理论实验用
   - 平均输入功率（W）：验证实验用
   - 采样频率（Hz）：默认87500
4. **开始计算**：点击"开始统一计算"按钮
5. **查看结果**：
   - 效率结果：查看正向、反向和综合效率
   - 数据统计：查看各通道最大值、最小值、平均值
   - 图表分析：查看电流、功率曲线对比
6. **导出报告**：生成包含所有分析结果的文本报告

## 数据格式

### CSV文件格式
```
时间戳, AIN1, AIN2, AIN3, AIN4, AIN5, AIN6, AIN7, AIN8
0.000, 2.531, 2.532, 0.000, 0.000, 2.533, 2.534, 2.535, 0.000
0.011, 2.541, 2.542, 0.000, 0.000, 2.543, 2.544, 2.545, 0.000
...
```

### 通道分配
- AIN1: 发电机输出电压（验证实验）
- AIN2: 发电机输出电流（验证实验）
- AIN3-4: 预留
- AIN5: 发电机输出电压（理论实验）
- AIN6: 发电机输出电流（理论实验）
- AIN7: 驱动电机输入电流（理论实验）
- AIN8: 预留

## 注意事项

1. **电机匹配**：确保两台电机型号完全相同，以满足双机标定法的假设条件
2. **稳态测量**：等待系统达到热平衡后再进行测量，避免暂态影响
3. **数据质量**：检查数据中是否存在异常值或噪声，必要时使用数据截取功能
4. **负载选择**：选择合适的负载电阻，使电机工作在最佳效率区间
5. **温度控制**：注意环境温度对测量的影响，必要时进行温度补偿

## 故障排除

### 常见问题
1. **计算失败**：检查CSV文件格式是否正确，参数是否合理
2. **效率异常**：验证电流传感器校准参数是否准确
3. **数据导入错误**：确保文件编码为UTF-8，无特殊字符
4. **界面无响应**：数据量过大时，考虑使用数据截取功能
